{% extends 'blog/base.html' %}

{% block main %}
<!-- Blog Post -->
<h1>{{ post.title }}</h1>

<p class="lead">
    by <a href="#">{{ post.auther }}</a>
</p>
<hr>

<p><span class="glyphicon glyphicon-time"></span> Posted on {{ post.published_date }}</p>
<hr>

<!-- Preview Image -->
{% if post.image %}
<img class="img-responsive" src="{{ post.image.url }}" alt="">
<hr>
{% endif %}

<!-- Gallery -->
{% if post.gallery.all %}
<h3>–ì–∞–ª–µ—Ä–µ—è</h3>
<div style="
    display: flex;
    flex-wrap: wrap;
    gap: 15px;
    justify-content: center;
    margin-top: 15px;
">
    {% for img in post.gallery.all %}
        <div style="flex: 0 0 30%; max-width: 30%;">
            <img src="{{ img.image.url }}" alt="" style="
                width: 100%;
                height: auto;
                border-radius: 8px;
                transition: transform 0.3s ease, box-shadow 0.3s ease;
            " onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 0 15px rgba(0,0,0,0.4)';"
              onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='none';">
            {% if img.caption %}
              <p style="text-align:center; color:#888; margin-top:5px;">{{ img.caption }}</p>
            {% endif %}
        </div>
    {% endfor %}
</div>
<hr>
{% endif %}

<!-- Post Content -->
<p class="lead">{{ post.content|linebreaks }}</p>
<hr>

<!-- –û—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ –æ—Å—Ç–∞—ë—Ç—Å—è —Ç–µ–º –∂–µ -->
<div class="well" style="background: #e3f2fd; border: 1px solid #2196f3;">
    <h4>üìß –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –Ω–æ–≤–æ—Å—Ç–∏</h4>

    {% if subscription_success %}
        <div class="alert alert-success">
            ‚úÖ –°–ø–∞—Å–∏–±–æ –∑–∞ –ø–æ–¥–ø–∏—Å–∫—É, —Ç–µ–ø–µ—Ä—å –≤—ã –±—É–¥–µ—Ç–µ –ø–æ–ª—É—á–∞—Ç—å –Ω–æ–≤–æ—Å—Ç–∏
        </div>
    {% endif %}

    <form method="POST">
        {% csrf_token %}
        <div class="form-group">
            <input type="email" name="email" class="form-control" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à email..." required style="padding: 12px; font-size: 16px;">
        </div>
        <button type="submit" name="subscribe_submit" class="btn btn-primary btn-lg">
            –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è
        </button>
    </form>
</div>

<hr>

<div class="well">
    <h4>üí¨ –û—Å—Ç–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</h4>

    {% if comment_success %}
        <div class="alert alert-success">
            ‚úÖ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –¥–æ–±–∞–≤–ª–µ–Ω
        </div>
    {% endif %}

    {% if user.is_authenticated %}
        <form method="POST">
            {% csrf_token %}
            <div class="form-group">
                <textarea name="text" class="form-control" rows="4" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ —Å–≤–æ–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π..." required style="font-size: 16px; padding: 12px;"></textarea>
            </div>
            <button type="submit" name="comment_submit" class="btn btn-success btn-lg">
                üìù –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
            </button>
        </form>
    {% else %}
        <div class="alert alert-info">
            üîê –ß—Ç–æ–±—ã –æ—Å—Ç–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
            <a href="{% url 'blog_login' %}" class="alert-link">–≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É</a>.
        </div>
    {% endif %}
</div>

<hr>

<h3>üí¨ –ö–æ–º–µ–Ω—Ç–∞—Ä–∏–∏ ({{ comments.count }})</h3>

{% for comment in comments %}
<div class="media" style="margin-bottom: 25px; padding: 20px; border: 1px solid #e0e0e0; border-radius: 10px; background: #fafafa;">
    <a class="pull-left" href="#">
        <img class="media-object" src="http://placehold.it/64x64" alt="" style="border-radius: 50%;">
    </a>
    <div class="media-body">
        <h4 class="media-heading">
            <strong style="color: #2c3e50;">{{ comment.author.username }}</strong>
            <small style="color: #7f8c8d;">{{ comment.created_at|date:"d.m.Y –æ H:i" }}</small>
        </h4>
        <p style="font-size: 16px; line-height: 1.6; color: #34495e; margin-top: 10px;">
            {{ comment.text|linebreaks }}
        </p>
    </div>
</div>
{% empty %}
<div class="alert alert-info" style="text-align: center; font-size: 16px;">
    üìù –ö–æ–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –Ω–µ—Ç. –ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º–∏
</div>
{% endfor %}
{% endblock %}
